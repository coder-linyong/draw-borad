(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"22dd":function(t,e,o){t.exports={brushContainer:"brush_brushContainer_2l19Z"}},"4aa7":function(t,e,o){t.exports={content:"Index_content_1FGv_",dropImg:"Index_dropImg_2-hK7"}},5408:function(t,e,o){t.exports={imgContainer:"resizeable_imgContainer_3pbcw",img:"resizeable_img_4KbBH",drop:"resizeable_drop_3mpFh",lt:"resizeable_lt_1_Ib_",rt:"resizeable_rt_3pTNC",rb:"resizeable_rb_2-_Ir",lb:"resizeable_lb_2W2z4",rotate:"resizeable_rotate_2_RhB"}},"5b88":function(t,e,o){"use strict";var n=o("4aa7"),s=o.n(n);o.d(e,"default",(function(){return s.a}))},"712e":function(t,e,o){"use strict";var n=o("5408"),s=o.n(n);o.d(e,"default",(function(){return s.a}))},"8b24":function(t,e,o){"use strict";o.r(e);var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("q-page",{staticClass:"items-center justify-evenly column overflow-hidden"},[o("div",{staticClass:"row full-width bg-primary text-white q-pa-xs justify-center q-gutter-md"},[o("q-btn",{attrs:{dense:"",flat:"",round:"",icon:"brush"},on:{click:function(e){t.drawStatus="brush"}}},[o("q-menu",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale"}},[o("BrushComponent",{attrs:{brushSync:t.brush},on:{"update:brushSync":function(e){t.brush=e},"update:brush-sync":function(e){t.brush=e}}})],1)],1),o("q-btn",{attrs:{dense:"",flat:"",round:"",icon:"iconfont dbxingzhuang"},on:{click:function(e){return t.showImg()}}},[o("q-tooltip",[t._v("添加2D形状")])],1),o("q-btn",{attrs:{dense:"",flat:"",round:"",icon:"image"},on:{click:t.chooseFile}},[o("q-tooltip",[t._v("添加图片")])],1),o("q-btn",{attrs:{dense:"",flat:"",round:"",icon:"title"}},[o("q-tooltip",[t._v("添加文本")])],1),o("q-btn",{attrs:{dense:"",flat:"",round:"",icon:"iconfont dbxiangpicha"},on:{click:function(e){t.drawStatus="eraser"}}},[o("q-menu",{attrs:{anchor:"bottom middle",self:"top middle","transition-show":"scale","transition-hide":"scale"}},[o("EraserComponent",{attrs:{eraserSync:t.eraser},on:{"update:eraserSync":function(e){t.eraser=e},"update:eraser-sync":function(e){t.eraser=e}}})],1)],1),o("q-btn",{attrs:{dense:"",flat:"",round:"",icon:"refresh"},on:{click:t.reset}},[o("q-tooltip",[t._v("重置画板")])],1),o("q-btn",{attrs:{dense:"",flat:"",round:"",icon:"download"},on:{click:t.download}},[o("q-tooltip",[t._v("保存为图片")])],1),o("q-btn",{attrs:{dense:"",flat:"",round:"",icon:"undo"},on:{click:function(e){return t.move(-1)}}},[o("q-tooltip",[t._v("撤销")])],1),o("q-btn",{attrs:{dense:"",flat:"",round:"",icon:"redo"},on:{click:function(e){return t.move(1)}}},[o("q-tooltip",[t._v("重做")])],1)],1),o("q-drawer",{attrs:{side:"right",overlay:"",behavior:"desktop",bordered:""},model:{value:t.right,callback:function(e){t.right=e},expression:"right"}}),o("div",{ref:"content",staticClass:"col full-width",class:t.$style.content,on:{mousedown:t.contentMouseDown,wheel:t.contentWheel,mouseup:t.contentMouseUp}},[o("canvas",{ref:"board",style:{transform:"translate3d("+t.translatePos.x+"px,"+t.translatePos.y+"px,"+t.translatePos.z+"px)",cursor:t.cursor},attrs:{id:"board"},on:{mousedown:t.boardMouseDown,mousemove:t.boardMouseMove,mouseup:t.boardMouseUp,dragenter:function(e){return e.preventDefault(),t.dropHandler(e)},dragleave:function(e){return e.preventDefault(),t.dropHandler(e)},dragover:function(e){return e.preventDefault(),t.dropHandler(e)},drop:function(e){return e.preventDefault(),t.dropHandler(e)},contextmenu:function(t){t.preventDefault()}}})])],1)},s=[],i=o("60a3"),r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("q-card",{staticClass:"q-pa-md",class:t.$style.brushContainer},[o("q-card-section",[o("div",{staticClass:"row"},[o("div",[t._v("粗细")]),o("q-space"),o("div",[t._v(t._s(t.brush.size)+"px")])],1),o("q-slider",{attrs:{min:t.minSize,max:t.maxSize,step:1},model:{value:t.brush.size,callback:function(e){t.$set(t.brush,"size",e)},expression:"brush.size"}}),o("div",{staticClass:"row"},[o("div",[t._v("不透明度")]),o("q-space"),o("div",[t._v(t._s((100*t.brush.transparency/255).toFixed(2))+"%")])],1),o("q-slider",{attrs:{min:t.minTransparency,max:t.maxTransparency,step:1},model:{value:t.brush.transparency,callback:function(e){t.$set(t.brush,"transparency",e)},expression:"brush.transparency"}}),o("div",{staticClass:"row items-center"},[o("div",[t._v("颜色")]),o("q-space"),o("q-btn",{style:{background:t.brush.color},attrs:{round:"",dense:""}},[o("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[o("q-color",{model:{value:t.brush.color,callback:function(e){t.$set(t.brush,"color",e)},expression:"brush.color"}})],1)],1)],1)],1)],1)},a=[];class l{constructor({size:t=1,transparency:e=255,color:o="#000"}={}){const{maxSize:n,minSize:s,maxTransparency:i,minTransparency:r}=l;this.size=t<s?s:Math.min(n,t),this.transparency=e<r?r:Math.min(i,e),this.color=o}}l.maxSize=100,l.minSize=1,l.maxTransparency=255,l.minTransparency=1;var c=function(t,e,o,n){var s,i=arguments.length,r=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(i<3?s(r):i>3?s(e,o,r):s(e,o))||r);return i>3&&r&&Object.defineProperty(e,o,r),r};let h=class extends i["f"]{constructor(){super(...arguments),this.minSize=l.minSize,this.maxSize=l.maxSize,this.minTransparency=l.minTransparency,this.maxTransparency=l.maxTransparency}};c([Object(i["d"])("brushSync")],h.prototype,"brush",void 0),h=c([i["a"]],h);var d=h,u=d,p=o("f403"),m=o("2877"),b=o("f09f"),f=o("a370"),v=o("2c91"),y=o("c1d0"),g=o("9c40"),w=o("7cbe"),x=o("b498"),C=o("eebe"),S=o.n(C);function T(t){this["$style"]=p["default"].locals||p["default"]}var q=Object(m["a"])(u,r,a,!1,T,null,null),_=q.exports;S()(q,"components",{QCard:b["a"],QCardSection:f["a"],QSpace:v["a"],QSlider:y["a"],QBtn:g["a"],QPopupProxy:w["a"],QColor:x["a"]});var k=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("q-card",{staticClass:"q-pa-md",class:t.$style.eraserContainer},[o("q-card-section",[o("div",{staticClass:"row"},[o("div",[t._v("大小")]),o("q-space"),o("div",[t._v(t._s(t.eraser.size)+"px")])],1),o("q-slider",{attrs:{min:t.minSize,max:t.maxSize,step:1},model:{value:t.eraser.size,callback:function(e){t.$set(t.eraser,"size",e)},expression:"eraser.size"}})],1)],1)},P=[];class z{constructor({size:t=1}={}){const{maxSize:e,minSize:o}=z;this.size=t<o?o:Math.min(e,t)}}z.maxSize=100,z.minSize=1;var D=function(t,e,o,n){var s,i=arguments.length,r=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(i<3?s(r):i>3?s(e,o,r):s(e,o))||r);return i>3&&r&&Object.defineProperty(e,o,r),r};let M=class extends i["f"]{constructor(){super(...arguments),this.minSize=z.minSize,this.maxSize=z.maxSize}};D([Object(i["d"])("eraserSync")],M.prototype,"eraser",void 0),M=D([i["a"]],M);var j=M,O=j,$=o("a71d");function R(t){this["$style"]=$["default"].locals||$["default"]}var W=Object(m["a"])(O,k,P,!1,R,null,null),B=W.exports;S()(W,"components",{QCard:b["a"],QCardSection:f["a"],QSpace:v["a"],QSlider:y["a"]});var Q=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{ref:"container",class:t.$style.imgContainer,on:{wheel:function(t){t.stopPropagation()},mousemove:t.mouseMove,mouseup:t.mouseup,mousedown:function(e){return e.preventDefault(),t.mouseDown(e)}}},[o("div",{ref:"box",class:t.$style.img,style:t.imgStyle,on:{mousedown:function(t){t.preventDefault()}}},["img"===t.type?o("img",{ref:"img",attrs:{src:t.url,width:t.width-2*t.padding,height:t.height-2*t.padding},on:{mousedown:function(t){t.preventDefault()}}}):t._e(),"shape"===t.type?o("canvas",{ref:"img",attrs:{width:t.width-2*t.padding,height:t.height-2*t.padding},on:{mousedown:function(t){t.preventDefault()}}}):t._e(),t._l(t.dropBlock,(function(e){return o("div",{class:[t.$style.drop,t.$style[e]],attrs:{"data-pos":e},on:{mousedown:function(t){t.preventDefault()}}})})),o("q-btn",{staticClass:"absolute-center bg-white",style:{transform:"translate(-50%,-50%) rotate("+-t.rotate+"deg)"},attrs:{flat:"",dense:"",icon:"done",round:""},on:{click:t.complete}})],2),o("q-slider",{staticClass:"absolute-bottom",class:t.$style.rotate,staticStyle:{width:"300px"},attrs:{max:360,min:0,label:"","label-value":t.rotate+"°"},model:{value:t.rotate,callback:function(e){t.rotate=e},expression:"rotate"}}),"shape"===t.type?o("q-btn",{staticClass:"absolute-bottom-right bg-white",attrs:{icon:"edit",round:"",dense:""},on:{click:function(e){t.visible=!0}}}):t._e(),"shape"===t.type?o("q-dialog",{attrs:{position:"right"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[o("q-card",{staticClass:"relative-position",staticStyle:{width:"300px"}},[o("q-card-section",{staticClass:"row items-center justify-end"},[o("q-btn",{attrs:{dense:"",round:"",icon:"close",flat:"",size:"sm"},on:{click:function(e){t.visible=!1}}})],1),o("ShapeEditor",{attrs:{shapeSync:t.shape},on:{"update:shapeSync":function(e){t.shape=e},"update:shape-sync":function(e){t.shape=e},change:t.onShapeChange,choose:t.onChoose}})],1)],1):t._e()],1)},N=[],I=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("q-card-section",[o("div",{staticClass:"row"},[t._v("形状")]),o("div",{staticClass:"q-gutter-sm row q-pa-none q-py-sm"},t._l(t.shapes,(function(e){return o("q-btn",{attrs:{Key:e.name,icon:"iconfont "+e.icon,size:"20px",color:t.currClassName===e.name?"primary":"white","text-color":t.currClassName===e.name?"white":"primary"},on:{click:function(o){return t.onChoose(e.name)}}},[o("q-tooltip",[t._v(t._s(e.label))])],1)})),1),"Polygon"===t.currClassName?o("div",{staticClass:"row items-center q-py-sm"},[o("div",[t._v("半径")]),o("q-space"),o("q-input",{staticStyle:{width:"70px"},attrs:{type:"number",outlined:"",dense:"",min:t.minRadius},model:{value:t.option.radius,callback:function(e){t.$set(t.option,"radius",e)},expression:"option.radius"}}),o("div",[t._v("像素")])],1):t._e(),"Polygon"===t.currClassName?o("div",{staticClass:"row items-center q-py-sm"},[o("div",[t._v("边数")]),o("q-space"),o("q-input",{staticStyle:{width:"70px"},attrs:{type:"number",outlined:"",dense:"",min:t.minBorderNumber},model:{value:t.option.borderNumber,callback:function(e){t.$set(t.option,"borderNumber",e)},expression:"option.borderNumber"}})],1):t._e(),o("div",{staticClass:"row items-center q-py-sm"},[o("q-toggle",{attrs:{color:t.option.fillColor,label:t.option.fill?"填充":"不填充"},model:{value:t.option.fill,callback:function(e){t.$set(t.option,"fill",e)},expression:"option.fill"}}),o("q-space"),o("q-btn",{staticClass:"shadow-0 q-mr-sm",style:{background:t.option.fillColor},attrs:{round:"",dense:"",disable:!t.option.fill}},[o("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[o("q-color",{model:{value:t.option.fillColor,callback:function(e){t.$set(t.option,"fillColor",e)},expression:"option.fillColor"}})],1)],1)],1),o("div",{staticClass:"row items-center q-py-sm"},[o("q-toggle",{attrs:{color:t.option.borderColor,label:t.option.border?"描边":"不描边"},model:{value:t.option.border,callback:function(e){t.$set(t.option,"border",e)},expression:"option.border"}}),o("q-space"),o("q-btn",{staticClass:"shadow-0 q-mr-sm",style:{background:t.option.borderColor},attrs:{round:"",dense:"",disable:!t.option.border}},[o("q-popup-proxy",{attrs:{"transition-show":"scale","transition-hide":"scale"}},[o("q-color",{model:{value:t.option.borderColor,callback:function(e){t.$set(t.option,"borderColor",e)},expression:"option.borderColor"}})],1)],1)],1),o("div",{staticClass:"row"},[o("div",[t._v("描边粗细")]),o("q-space"),o("div",[t._v(t._s(t.option.borderWidth)+"像素")])],1),o("q-slider",{attrs:{min:t.minBorderWidth,max:t.maxBorderWidth,step:1},model:{value:t.option.borderWidth,callback:function(e){t.$set(t.option,"borderWidth",e)},expression:"option.borderWidth"}}),o("div",{staticClass:"row items-center q-py-sm"},[o("div",[t._v("描边线长")]),o("q-space"),o("q-input",{staticStyle:{width:"70px"},attrs:{type:"number",outlined:"",dense:"",min:0},model:{value:t.option.lineDash[0],callback:function(e){t.$set(t.option.lineDash,0,e)},expression:"option.lineDash[0]"}}),o("div",[t._v("像素")])],1),o("div",{staticClass:"row items-center q-py-sm"},[o("div",[t._v("描边线间隙")]),o("q-space"),o("q-input",{staticStyle:{width:"70px"},attrs:{type:"number",outlined:"",dense:"",min:0},model:{value:t.option.lineDash[1],callback:function(e){t.$set(t.option.lineDash,1,e)},expression:"option.lineDash[1]"}}),o("div",[t._v("像素")])],1),o("div",{staticClass:"row"},[o("div",[t._v("不透明度")]),o("q-space"),o("div",[t._v(t._s(t.option.transparency)+"%")])],1),o("q-slider",{attrs:{min:t.minTransparency,max:t.maxTransparency,step:1},model:{value:t.option.transparency,callback:function(e){t.$set(t.option,"transparency",e)},expression:"option.transparency"}})],1)},E=[];class H{constructor({lineDash:t=[0,0],border:e=!0,borderColor:o="#000",borderWidth:n=10,fill:s=!1,fillColor:i="#000",transparency:r=100,x:a=0,y:l=0}={}){this[Symbol.toStringTag]="Shape",this.lineDash=[t[0],t[1]],this.border=!e&&!s||e,this.borderColor=o,this.borderWidth=[H.minBorderWidth,H.maxBorderWidth,n].sort()[1],this.fill=s,this.fillColor=i,this.transparency=[H.minTransparency,H.maxTransparency,r].sort()[1],this.x=a,this.y=l}setStyle(t){const{x:e=0,y:o=0,borderColor:n="#000",borderWidth:s=10,fillColor:i="#000",lineDash:r=[0,0],transparency:a=100}=this;t.save(),t.translate(e,o),t.setLineDash(r),t.fillStyle=i,t.lineWidth=s,t.globalAlpha=a/100,t.strokeStyle=n}complete(t){const{border:e,fill:o}=this;e||o||(this.border=!0),e&&t.stroke(),o&&t.fill(),t.restore()}}H.maxTransparency=100,H.minTransparency=1,H.maxBorderWidth=100,H.minBorderWidth=1;class L extends H{constructor(t){super(t),this[Symbol.toStringTag]="Polygon",this.radius=t.radius,this.borderNumber=Math.max(t.borderNumber,L.minBorderWidth)}draw(t){const{borderNumber:e,radius:o}=this,{canvas:{width:n,height:s}}=t;t.clearRect(0,0,n,s),this.setStyle(t);const i=2*Math.PI/e;t.beginPath();for(let r=0;r<2*Math.PI;r+=i){const e=Math.cos(r)*o,n=Math.sin(r)*o;t.lineTo(e,n)}t.closePath(),this.complete(t)}}L.minRadius=50,L.minBorderNumber=3;var U=function(t,e,o,n){var s,i=arguments.length,r=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(i<3?s(r):i>3?s(e,o,r):s(e,o))||r);return i>3&&r&&Object.defineProperty(e,o,r),r};let F=class extends i["f"]{constructor(){super(...arguments),this.minTransparency=H.minTransparency,this.maxTransparency=H.maxTransparency,this.minBorderWidth=H.minBorderWidth,this.maxBorderWidth=H.maxBorderWidth,this.minRadius=L.minRadius,this.minBorderNumber=L.minBorderNumber,this.option={border:!1,borderColor:"",borderNumber:L.minBorderNumber,borderWidth:0,fill:!1,fillColor:"",lineDash:[0,0],radius:L.minRadius,transparency:0,x:0,y:0},this.shapes=[{icon:"dbduobianxing",name:"Polygon",label:"多边形"},{icon:"dbliuchengtujiaonangxing",name:"Capsule",label:"胶囊形"},{icon:"dbzhijiaosanjiaoxing",name:"RightTriangle",label:"直角三角形"},{icon:"dbjiantou",name:"Arrow",label:"指向箭头"},{icon:"dbxing",name:"Star",label:"五角星"},{icon:"dbqipao",name:"Bubble",label:"气泡"},{icon:"dbgou",name:"Hook",label:"钩"},{icon:"dbcuohao",name:"Fork",label:"叉号"}]}get currClassName(){return this.shape[Symbol.toStringTag]}onChange(){return!0}onChoose(t){return t}optionChange(t){const{shape:e}=this;for(const o of Object.keys(t))o in e&&(e[o]=t[o]);this.onChange()}updateOption(){const{shape:t,option:e}=this;for(const o of Object.keys(t))e[o]=t[o]}mounted(){setTimeout((()=>{this.updateOption()}),100)}};U([Object(i["d"])("shapeSync")],F.prototype,"shape",void 0),U([Object(i["b"])("change")],F.prototype,"onChange",null),U([Object(i["b"])("choose")],F.prototype,"onChoose",null),U([Object(i["g"])("option",{deep:!0})],F.prototype,"optionChange",null),F=U([Object(i["a"])({})],F);var K=F,A=K,J=o("05c0"),Y=o("27f9"),X=o("9564"),G=Object(m["a"])(A,I,E,!1,null,null,null),V=G.exports;S()(G,"components",{QCardSection:f["a"],QBtn:g["a"],QTooltip:J["a"],QSpace:v["a"],QInput:Y["a"],QToggle:X["a"],QPopupProxy:w["a"],QColor:x["a"],QSlider:y["a"]});class Z extends H{constructor(t){super(t),this[Symbol.toStringTag]="Capsule"}draw(t){const{canvas:{width:e,height:o}}=t;t.clearRect(0,0,e,o);const{borderWidth:n=10}=this,s=Math.min(e,o)/2-n;this.setStyle(t),t.beginPath(),t.arc(0,-o/2+n+s,s,0,Math.PI,!0),t.arc(0,o/2-n-s,s,Math.PI,0,!0),t.closePath(),this.complete(t)}}class tt extends H{constructor(t){super(t),this[Symbol.toStringTag]="RightTriangle"}draw(t){const{canvas:{width:e,height:o}}=t;t.clearRect(0,0,e,o);const{borderWidth:n=10}=this,s=(e-2*n)/2,i=(o-2*n)/2;this.setStyle(t),t.lineJoin="miter",t.beginPath(),t.moveTo(-s,-i),t.lineTo(-s,i),t.lineTo(s,i),t.closePath(),this.complete(t)}}class et extends H{constructor(t){super(t),this[Symbol.toStringTag]="Arrow"}draw(t){const{canvas:{width:e,height:o}}=t;t.clearRect(0,0,e,o);const{borderWidth:n=10}=this,s=e/2-n,i=o/2-n;this.setStyle(t),t.beginPath(),t.moveTo(0,i/2),t.lineTo(-s,i),t.lineTo(0,-i),t.lineTo(s,i),t.closePath(),this.complete(t)}}class ot extends H{constructor(t){super(t),this[Symbol.toStringTag]="Star",this.angleNum=t.angleNum}draw(t){const{canvas:{width:e,height:o}}=t;t.clearRect(0,0,e,o);const{borderWidth:n=10,angleNum:s}=this,i=Math.min(e,o)/2-n,r=i/2,a=2*Math.PI/s;this.setStyle(t),t.beginPath(),t.moveTo(0,r);for(let l=0;l<s;l++){const e=l*a+Math.PI/2,o=l*a+Math.PI/2+a/2;t.lineTo(Math.cos(e)*r,Math.sin(e)*r),t.lineTo(Math.cos(o)*i,Math.sin(o)*i)}t.closePath(),this.complete(t)}}class nt extends H{constructor(t){super(t),this[Symbol.toStringTag]="Bubble"}draw(t){const{canvas:{width:e,height:o}}=t;t.clearRect(0,0,e,o);const{borderWidth:n=10}=this,s=e/2-n,i=o/2-n;this.setStyle(t),t.lineJoin="round",t.beginPath(),t.moveTo(-s,-i),t.lineTo(s,-i),t.lineTo(s,i/2),t.lineTo(0,i/2),t.lineTo(2*-s/3,i),t.lineTo(-s/2,i/2),t.lineTo(-s,i/2),t.closePath(),this.complete(t)}}class st extends H{constructor(t){super(t),this[Symbol.toStringTag]="Hook"}draw(t){const{canvas:{width:e,height:o}}=t;t.clearRect(0,0,e,o);const{borderWidth:n=10}=this,s=e/2-n,i=o/2-n;this.setStyle(t),t.beginPath(),t.moveTo(s/2,-i),t.lineTo(s,-i/2),t.lineTo(-s/4,i),t.lineTo(-s,0),t.lineTo(-s/2,-i/2),t.lineTo(-s/4,0),t.closePath(),this.complete(t)}}class it extends H{constructor(t){super(t),this[Symbol.toStringTag]="Fork"}draw(t){const{canvas:{width:e,height:o}}=t;t.clearRect(0,0,e,o);const{borderWidth:n=10}=this,s=e/2-n,i=o/2-n;this.setStyle(t),t.beginPath(),t.moveTo(s/2,-i),t.lineTo(s,-i/2),t.lineTo(s/2,0),t.lineTo(s,i/2),t.lineTo(s/2,i),t.lineTo(0,i/2),t.lineTo(-s/2,i),t.lineTo(-s,i/2),t.lineTo(-s/2,0),t.lineTo(-s,-i/2),t.lineTo(-s/2,-i),t.lineTo(0,-i/2),t.closePath(),this.complete(t)}}var rt=function(t,e,o,n){var s,i=arguments.length,r=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(i<3?s(r):i>3?s(e,o,r):s(e,o))||r);return i>3&&r&&Object.defineProperty(e,o,r),r},at=function(t,e,o,n){function s(t){return t instanceof o?t:new o((function(e){e(t)}))}return new(o||(o=Promise))((function(o,i){function r(t){try{l(n.next(t))}catch(e){i(e)}}function a(t){try{l(n["throw"](t))}catch(e){i(e)}}function l(t){t.done?o(t.value):s(t.value).then(r,a)}l((n=n.apply(t,e||[])).next())}))};let lt=class extends i["f"]{constructor(){super(...arguments),this.padding=10,this.width=0,this.height=0,this.drop=!1,this.visible=!0,this.dropDirection="rb",this.rotate=0,this.move=!1,this.pos={x:0,y:0},this.shape=new L({borderNumber:L.minBorderNumber,radius:L.minRadius}),this.dropBlock=["lt","rt","rb","lb"]}get imgStyle(){const{pos:t,width:e,height:o,padding:n,rotate:s}=this;return{left:`${t.x}px`,top:`${t.y}px`,padding:`${n}px`,width:e?`${e}px`:"auto",height:o?`${o}px`:"auto",transform:`translate(-50%, -50%) rotate(${s}deg)`}}complete(){const{rotate:t,img:e,pos:{x:o,y:n}}=this,{clientWidth:s,clientHeight:i}=e;return{rotate:t,x:o-s/2,y:n-i/2,width:s,height:i}}onChoose(t){"Polygon"===t?this.shape=new L({borderNumber:L.minBorderNumber,radius:L.minRadius}):"Capsule"===t?this.shape=new Z({}):"RightTriangle"===t?this.shape=new tt({}):"Arrow"===t?this.shape=new et({}):"Star"===t?this.shape=new ot({angleNum:5}):"Bubble"===t?this.shape=new nt({}):"Hook"===t?this.shape=new st({}):"Fork"===t&&(this.shape=new it({})),this.onShapeChange()}onShapeChange(){const{shape:t,img:e,ctx:o}=this;t.x=e.width/2,t.y=e.height/2,t.draw(o)}mouseDown(t){var e,o,n,s;const{pos:i}=null!==(o=null===(e=null===t||void 0===t?void 0:t.target)||void 0===e?void 0:e.dataset)&&void 0!==o&&o,r=null!==(s=null===(n=null===t||void 0===t?void 0:t.target)||void 0===n?void 0:n.nodeName)&&void 0!==s?s:"";i?(this.drop=!0,this.dropDirection=i):"IMG"!==r&&"CANVAS"!==r||(this.move=!0)}mouseMove(t){const{drop:e,move:o,dropDirection:n}=this,{movementX:s,movementY:i}=t;if(e){let t=0,e=0;"rb"===n?(t=this.width+s,e=this.height+i):"lt"===n?(t=this.width-s,e=this.height-i):"rt"===n?(t=this.width+s,e=this.height-i):"lb"===n&&(t=this.width-s,e=this.height+i),this.width=Math.max(100,t),this.height=Math.max(100,e),this.ctx&&setTimeout((()=>{this.onShapeChange()}),10)}else o&&(this.pos.x+=s,this.pos.y+=i)}mouseup(){this.drop=!1,this.move=!1}init(){return at(this,void 0,void 0,(function*(){return new Promise((t=>{setTimeout((()=>{const{container:e,box:o,img:n}=this;this.pos={x:e.clientWidth/2,y:e.clientHeight/2},this.width=o.clientWidth,this.height=o.clientHeight,n instanceof HTMLCanvasElement&&(this.ctx=n.getContext("2d"),this.shape.draw(this.ctx)),t(!0)}),50)}))}))}mounted(){return at(this,void 0,void 0,(function*(){yield this.init()}))}};rt([Object(i["c"])({type:String})],lt.prototype,"url",void 0),rt([Object(i["c"])({type:String,required:!0})],lt.prototype,"type",void 0),rt([Object(i["e"])("container")],lt.prototype,"container",void 0),rt([Object(i["e"])("box")],lt.prototype,"box",void 0),rt([Object(i["e"])("img")],lt.prototype,"img",void 0),rt([Object(i["b"])("complete")],lt.prototype,"complete",null),lt=rt([Object(i["a"])({components:{ShapeEditor:V}})],lt);var ct=lt,ht=ct,dt=o("712e"),ut=o("24e8");function pt(t){this["$style"]=dt["default"].locals||dt["default"]}var mt=Object(m["a"])(ht,Q,N,!1,pt,null,null),bt=mt.exports;S()(mt,"components",{QBtn:g["a"],QSlider:y["a"],QDialog:ut["a"],QCard:b["a"],QCardSection:f["a"]});var ft,vt=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},yt=function(t,e,o){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,o),o};class gt extends Array{constructor(t,...e){super(...e),ft.set(this,-1),this.length=t}get pointerPos(){return vt(this,ft)}get realLength(){let t=0;return this.forEach((e=>e&&t++)),t}push(...t){const e=this.length,o=vt(this,ft),n=e-o-1;if(t.splice(0,t.length-e),n<t.length){const e=t.length-n;super.splice(0,e),this.move(-e)}if(vt(this,ft)<this.realLength-1)for(let s=vt(this,ft)+1;s<=e;s++)this[s]=void 0;for(let s=yt(this,ft,+vt(this,ft)+1),i=0;i<t.length;s++,i++)this[s]=t[i];return this.length}unshift(...t){return super.unshift(...t),super.splice(this.length),this.length}move(t=1){return t>0?yt(this,ft,vt(this,ft)+t>=this.length?this.length-1:vt(this,ft)+t):t<0&&yt(this,ft,vt(this,ft)+t<0?0:vt(this,ft)+t),console.log(vt(this,ft)),this[vt(this,ft)]}}function wt(t){return new gt(t)}ft=new WeakMap;var xt=function(t,e,o,n){var s,i=arguments.length,r=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(r=(i<3?s(r):i>3?s(e,o,r):s(e,o))||r);return i>3&&r&&Object.defineProperty(e,o,r),r};let Ct=class extends i["f"]{constructor(){super(...arguments),this.right=!1,this.ctrl=!1,this.isMouseDown=!1,this.drawStatus="brush",this.oldPoint={x:0,y:0},this.translatePos={x:0,y:0,z:0},this.brush=new l,this.eraser=new z}get cursor(){const{ctrl:t,isMouseDown:e}=this;return t?"move":e?"crosshair":void 0}brushChange(t){const{ctx:e}=this;e.lineWidth=t.size,e.strokeStyle=t.color,e.fillStyle=t.color,e.globalAlpha=t.transparency/255}eraserChange(t){const{ctx:e}=this;e.lineWidth=t.size}putHistory(){const{board:t,ctx:e,history:o}=this;o.push(e.getImageData(0,0,t.width,t.height)),console.log(o)}move(t){const{ctx:e,history:o}=this;if(t>0&&o.realLength<=o.pointerPos+1)return;const n=o.move(t);n&&(this.reset(),e.putImageData(n,0,0))}reset(){const{ctx:t,board:e}=this;t.clearRect(0,0,e.width,e.height)}download(){const{board:t}=this,e=document.createElement("a");e.href=t.toDataURL(),e.download="img",e.click()}showImg(t){const{content:e,ctx:o}=this,n=new bt({propsData:{url:t,type:t?"img":"shape"}});n.$mount(),e.appendChild(n.$el),n.$on("complete",(t=>{const{x:s,y:i,width:r,height:a,rotate:l}=t;o.save(),o.translate(s+r/2,i+a/2),o.rotate(l*Math.PI/180),o.drawImage(n.img,-r/2,-a/2,r,a),o.restore(),e.removeChild(n.$el),n.$destroy(),this.putHistory()}))}chooseFile(){const t=document.createElement("input");t.type="file",t.accept="image/*",t.click(),t.addEventListener("change",(()=>{const{files:e}=t;if(e&&e.length>0){const t=URL.createObjectURL(e[0]);this.showImg(t)}}))}keyUp(t){const{key:e}=t;"Control"===e&&(this.ctrl=t.ctrlKey)}keyDown(t){const{key:e}=t;"Control"===e&&(this.ctrl=t.ctrlKey)}boardMouseDown(t){if(t.ctrlKey)return;const{offsetX:e,offsetY:o}=t,{ctx:n,drawStatus:s,brush:i,eraser:r}=this;this.oldPoint={x:e,y:o},this.isMouseDown=!0,"brush"===s?n.lineWidth=i.size:"eraser"===s&&(n.lineWidth=r.size)}boardMouseMove(t){const{offsetX:e,offsetY:o,ctrlKey:n}=t,{drawStatus:s,ctx:i,isMouseDown:r,board:a}=this;if(e<=1||e>=a.width-1||o<=1||o>=a.height-1||n)this.isMouseDown=!1;else if(r){const{oldPoint:{x:t,y:n}}=this;"brush"===s?(i.beginPath(),i.moveTo(t,n),i.lineTo(e,o),i.closePath(),i.stroke()):"eraser"===s&&(i.save(),i.globalCompositeOperation="destination-out",i.beginPath(),i.moveTo(t,n),i.lineTo(e,o),i.closePath(),i.stroke(),i.restore()),this.oldPoint={x:e,y:o}}}dropHandler(t){var e;if("drop"===t.type&&t.dataTransfer){const{files:o}=null!==(e=null===t||void 0===t?void 0:t.dataTransfer)&&void 0!==e?e:[];if(o&&o.length>0){const t=URL.createObjectURL(o[0]);this.showImg(t)}}}boardMouseUp(t){if(t.ctrlKey)return;const{drawStatus:e,isMouseDown:o}=this;o&&("brush"!==e&&"eraser"!==e||(this.isMouseDown=!1),this.putHistory())}contentMouseDown(){const{content:t,ctrl:e}=this;e&&t.addEventListener("mousemove",this.contentMouseMove)}contentMouseMove(t){const{translatePos:e}=this,{movementY:o,movementX:n}=t;e.x+=n,e.y+=o}contentWheel(t){const{translatePos:e}=this,{deltaY:o,ctrlKey:n}=t;n&&t.preventDefault(),o<0?e.z+=10:e.z-=10}contentMouseUp(){const{content:t}=this;t.removeEventListener("mousemove",this.contentMouseMove)}mounted(){var t;const{board:e}=this;if(window.addEventListener("keydown",this.keyDown),window.addEventListener("keyup",this.keyUp),null!==(t=e.getContext)&&void 0!==t&&t){const t=this.ctx=this.board.getContext("2d");setTimeout((()=>{t.lineCap="round",t.lineJoin="round"}))}e.width=document.body.clientWidth,e.height=document.body.clientHeight-48,this.history=wt(10),this.putHistory()}beforeDestroy(){window.removeEventListener("keydown",this.keyDown),window.removeEventListener("keyup",this.keyUp)}};xt([Object(i["e"])("board")],Ct.prototype,"board",void 0),xt([Object(i["e"])("content")],Ct.prototype,"content",void 0),xt([Object(i["g"])("brush",{deep:!0})],Ct.prototype,"brushChange",null),xt([Object(i["g"])("eraser",{deep:!0})],Ct.prototype,"eraserChange",null),Ct=xt([Object(i["a"])({components:{Resizeable:bt,EraserComponent:B,BrushComponent:_}})],Ct);var St=Ct,Tt=St,qt=o("5b88"),_t=o("9989"),kt=o("4e73"),Pt=o("9404");function zt(t){this["$style"]=qt["default"].locals||qt["default"]}var Dt=Object(m["a"])(Tt,n,s,!1,zt,null,null);e["default"]=Dt.exports;S()(Dt,"components",{QPage:_t["a"],QBtn:g["a"],QMenu:kt["a"],QTooltip:J["a"],QDrawer:Pt["a"]})},"8eca":function(t,e,o){t.exports={eraserContainer:"eraser_eraserContainer_2Fq9c"}},a71d:function(t,e,o){"use strict";var n=o("8eca"),s=o.n(n);o.d(e,"default",(function(){return s.a}))},f403:function(t,e,o){"use strict";var n=o("22dd"),s=o.n(n);o.d(e,"default",(function(){return s.a}))}}]);